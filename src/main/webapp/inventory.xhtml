<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="templates/index.xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core">


    <h:form id="tableForm">
        <p:commandButton value="New Item" onclick="#{p:widgetVar('newItemForm:newItemDlg')}.show()"/>
        <br/>
        <p:dataTable var="item" value="#{inventoryBean.items}" paginator="true" rows="30" 
                     paginatorTemplate="{FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
                     id="itemTable" lazy="true" resizableColumns="true">
            <p:column headerText="Name">
                <h:outputText value="#{item.name}"/>
            </p:column>
            <p:column headerText="Quantity">
                <h:outputText value="#{item.quantity}"/>
            </p:column>
            <p:column headerText="Units">
                <h:outputText value="#{item.units}"/>
            </p:column>
            <p:column>
                <p:commandButton value="Add quantity" onclick="#{p:widgetVar('addQtyForm:addQtyDlg')}.show()">
                    <f:setPropertyActionListener value="#{item.name}" target="#{inventoryBean.selected}"/>
                </p:commandButton>
            </p:column>
            <p:column>
                <p:commandButton value="Remove quantity" onclick="#{p:widgetVar('rmvQtyForm:rmvQtyDlg')}.show()">
                    <f:setPropertyActionListener value="#{item.name}" target="#{inventoryBean.selected}"/>
                </p:commandButton>
            </p:column>
            <p:column>
                <p:commandButton value="Delete" onclick="#{p:widgetVar('deleteForm:deleteDlg')}.show()">
                    <f:setPropertyActionListener value="#{item.name}" target="#{inventoryBean.selected}"/>
                </p:commandButton>
            </p:column>
        </p:dataTable>
    </h:form>

    <h:form id="newItemForm">
        <p:dialog id="newItemDlg" closable="false">
            <p:panelGrid columns="2">
                <h:outputText value="Item Name"/><p:inputText value="#{inventoryBean.name}"/>
                <h:outputText value="Quantity"/><p:inputNumber value="#{inventoryBean.quantity}"/>
                <h:outputText value="Units"/><p:inputText value="#{inventoryBean.units}"/>
                <p:commandButton value="Create Item" actionListener="#{inventoryBean.createItem}" 
                                 oncomplete="#{p:widgetVar('newItemForm:newItemDlg')}.hide()" update=":tableForm :growl"/>
                <p:commandButton value="Cancel" actionListener="#{inventoryBean.clear}" 
                                 oncomplete="#{p:widgetVar('newItemForm:newItemDlg')}.hide()"/>
            </p:panelGrid>
        </p:dialog>
    </h:form>
    <h:form id="addQtyForm">
        <p:dialog id="addQtyDlg" closable="false">
            <p:panelGrid columns="2">
                <h:outputText value="Quantity to add"/><p:inputNumber value="#{inventoryBean.quantityModifier}" minValue="0"/>
                <p:commandButton value="Submit" actionListener="#{inventoryBean.addQuantity}" 
                                 oncomplete="#{p:widgetVar('addQtyForm:addQtyDlg')}.hide()" update=":tableForm :growl"/>
                <p:commandButton value="Cancel" actionListener="#{inventoryBean.clear}" 
                                 oncomplete="#{p:widgetVar('addQtyForm:addQtyDlg')}.hide()"/>
            </p:panelGrid>
        </p:dialog>
    </h:form>
    <h:form id="rmvQtyForm">
        <p:dialog id="rmvQtyDlg" closable="false">
            <p:panelGrid columns="2">
                <h:outputText value="Quantity to remove"/><p:inputNumber value="#{inventoryBean.quantityModifier}" minValue="0"/>
                <p:commandButton value="Submit" actionListener="#{inventoryBean.removeQuantity}" 
                                 oncomplete="#{p:widgetVar('rmvQtyForm:rmvQtyDlg')}.hide()" update=":tableForm :growl"/>
                <p:commandButton value="Cancel" actionListener="#{inventoryBean.clear}" 
                                 oncomplete="#{p:widgetVar('rmvQtyForm:rmvQtyDlg')}.hide()"/>
            </p:panelGrid>
        </p:dialog>
    </h:form>
    <h:form id="deleteForm">
        <p:dialog id="deleteDlg" closable="false" header="Please confirm deletion">
            <p:panelGrid columns="2" style="border-width: 0">
                <p:commandButton value="Submit" actionListener="#{inventoryBean.deleteItem}" 
                                 oncomplete="#{p:widgetVar('deleteForm:deleteDlg')}.hide()" update=":tableForm :growl"/>
                <p:commandButton value="Cancel" actionListener="#{inventoryBean.clear}" 
                                 oncomplete="#{p:widgetVar('deleteForm:deleteDlg')}.hide()"/>
            </p:panelGrid>
        </p:dialog>
    </h:form>
</ui:composition>
